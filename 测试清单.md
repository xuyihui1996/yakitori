# 功能测试清单

## ✅ 已完成功能测试

### 1. 二维码功能测试

**测试步骤：**
1. 打开应用首页 (`http://localhost:5173/`)
2. 点击"创建新桌"
3. 输入昵称（如：小明）
4. 点击"创建并开始点单"

**预期结果：**
- ✅ 创建成功后弹出二维码弹窗
- ✅ 显示桌号（如：GABC123）
- ✅ 显示二维码图片（300x300）
- ✅ 显示加入链接（如：`http://localhost:5173/?groupId=GABC123`）
- ✅ 可以复制链接
- ✅ 点击"返回"关闭弹窗
- ✅ 点击"进入点单"跳转到组页面

**扫码测试：**
1. 用手机扫描二维码
2. 或用另一个浏览器打开链接：`http://localhost:5173/?groupId=GABC123`

**预期结果：**
- ✅ 自动跳转到"加入桌"模式
- ✅ 桌号字段自动填充（如：GABC123）
- ✅ 输入昵称后可以加入

---

### 2. 账单合并测试

**测试步骤：**
1. 在同一个轮次中，添加两个相同名称但不同备注的菜品：
   - 添加："やげん软骨"，备注："鸡胸软骨"，价格：¥200
   - 添加："やげん软骨"，备注："软骨"，价格：¥200
2. 每个各点1份
3. 进入"我的账单"页面

**预期结果：**
- ✅ 账单中只显示一个"やげん软骨"条目
- ✅ 备注显示为："鸡胸软骨 / 软骨"（用 " / " 分隔）
- ✅ 数量显示为：2（合并后的总数）
- ✅ 总价显示为：¥400（2 × ¥200）

**不同价格测试：**
1. 添加："つくね"，价格：¥165，点2份
2. 添加："つくね"，价格：¥180，点1份
3. 查看账单

**预期结果：**
- ✅ 账单中显示两个"つくね"条目（价格不同）
- ✅ 第一个：¥165 × 2 = ¥330
- ✅ 第二个：¥180 × 1 = ¥180

---

### 3. 停售功能测试

**测试步骤：**
1. 以Owner身份登录
2. 添加一个菜品（如："かわ"，价格：¥165）
3. 在菜单选择器中，找到该菜品
4. 点击菜品右侧的停售按钮（PowerOff图标）

**预期结果：**
- ✅ 菜品显示"已停售"标签（红色）
- ✅ 菜品变为半透明（opacity-50）
- ✅ 点击菜品无法选择
- ✅ 确认按钮禁用

**启用测试：**
1. 点击已停售菜品的启用按钮（Power图标，绿色）

**预期结果：**
- ✅ "已停售"标签消失
- ✅ 菜品恢复正常显示
- ✅ 可以正常选择和下单

**权限测试：**
1. 用非Owner身份登录（成员）
2. 查看菜单

**预期结果：**
- ✅ 看不到停售/启用按钮
- ✅ 可以正常选择未停售的菜品

---

### 4. 轮数显示格式测试

**测试步骤：**
1. 查看页面顶部的轮次显示
2. 查看"我的订单"标签页中的轮次标识
3. 查看"我的账单"页面中的轮次标识
4. 查看Owner汇总视图中的轮次标识

**预期结果：**
- ✅ 所有地方显示为："Round 1"、"Round 2" 等格式
- ✅ 不再显示 "R1"、"R2" 格式
- ✅ 格式统一且清晰

---

### 5. 数量加减按钮位置测试

**测试步骤：**
1. 在当前轮次中添加一些订单项
2. 查看"我的订单"区域

**预期结果：**
- ✅ 每个订单项下方显示加减按钮
- ✅ 减号按钮（-）在左侧
- ✅ 当前数量显示在中间
- ✅ 加号按钮（+）在右侧
- ✅ 减号按钮在数量为1时禁用

**加减测试：**
1. 点击加号按钮

**预期结果：**
- ✅ 数量立即增加（如：1 → 2）
- ✅ 总价立即更新
- ✅ 数据库同步更新

2. 点击减号按钮

**预期结果：**
- ✅ 数量立即减少（如：2 → 1）
- ✅ 总价立即更新
- ✅ 数量为1时减号按钮禁用

**历史轮次测试：**
1. 关闭当前轮次
2. 查看"历史轮"标签页

**预期结果：**
- ✅ 历史轮次的订单项不显示加减按钮
- ✅ 只显示订单信息，不可修改

---

## 🔍 测试环境

### 准备
1. 确保已安装依赖：`npm install`
2. 确保已配置Supabase环境变量（`.env.local`）
3. 启动开发服务器：`npm run dev`

### 多用户测试
建议同时打开多个浏览器窗口：
- 窗口1：Owner（小明）
- 窗口2：成员（小红）
- 窗口3：成员（小李）

---

## 📝 测试记录

### 测试日期：____/____/____

| 功能 | 状态 | 备注 |
|------|------|------|
| 二维码功能 | ⬜ 通过 / ⬜ 失败 | |
| 账单合并 | ⬜ 通过 / ⬜ 失败 | |
| 停售功能 | ⬜ 通过 / ⬜ 失败 | |
| 轮数显示 | ⬜ 通过 / ⬜ 失败 | |
| 加减按钮位置 | ⬜ 通过 / ⬜ 失败 | |

---

## 🐛 已知问题

### 1. 价格同步问题（待实现）
- **问题**：A用户更新菜单价格后，B用户的账单仍显示旧价格
- **影响**：需要刷新页面或等待下次数据加载
- **优先级**：中
- **预计修复**：实现实时监听或定期轮询

### 2. 结账确认流程（待实现）
- **问题**：缺少成员确认和Extra Round调整机制
- **影响**：无法处理上菜时数量不符的情况
- **优先级**：中
- **预计修复**：需要新数据结构和完整流程

---

## ✅ 测试通过标准

所有功能测试通过需满足：
1. ✅ 功能按预期工作
2. ✅ 界面显示正确
3. ✅ 数据同步正确
4. ✅ 无控制台错误
5. ✅ 移动端显示正常（可选）

---

## 🚀 下一步

完成测试后：
1. 记录测试结果
2. 报告任何发现的问题
3. 继续实现剩余功能：
   - 价格同步机制
   - 结账确认流程

